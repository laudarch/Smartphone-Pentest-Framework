#!/bin/sh

## Install needed packages

echo -e "$(tput setaf 1)\nInstallin serialport, dbdpg, and  expect for perl\n"; echo "$(tput sgr0)"
echo -e "$(tput setaf 1)#########################################\n"; echo "$(tput sgr0)"
echo $cwd;
#apt-get -y install libexpect-perl libdbd-pg-perl libdevice-serialport-perl; 
wget http://dl.google.com/android/android-sdk_r24.2-linux.tgz
tar -xvzf android-sdk_r24.2-linux.tgz
export PATH=${PATH}:${PWD}/android-sdk-linux/tools:${PWD}/android-sdk-linux/platform-tools
apt-get install ant
android update sdk --no-ui --filter platform-tools
android update sdk --no-ui --filter tools
android update sdk --no-ui --filter build-tools-19.1.0 -a
android update sdk --no-ui --filter android-4 -a
android update sdk --no-ui --filter addon-google_apis-google-4 -a
android update sdk --no-ui --filter android-14 -a
android update sdk --no-ui --filter addon-google_apis-google-14 -a
MACHINE_TYPE=`uname -m`
if [ ${MACHINE_TYPE} == 'x86_64' ]; then
  dpkg --add-architecture i386
  apt-get update
  apt-get install ia32-libs
  update-java-alternatives --jre -s java-1.7.0-openjdk-amd64
else
  update-java-alternatives --jre -s java-1.7.0-openjdk-i386
fi
echo -e "$(tput setaf 1)Creating first time 'framework' database (empty)\n"; echo "$(tput sgr0)"

service mysql start
mysqladmin password toor
mysqladmin -u root create framework -ptoor;
sed -i "s/post_max_size .*/post_max_size=100M/" /etc/php5/apache2/php.ini
sed -i "s/upload_max_filesize .*/upload_max_filesize =100M/" /etc/php5/apache2/php.ini
service apache2 start
echo -e "$(tput setaf 1)\n\nInstall of Smartphone Pentest Framework is complete!\n"; echo "$(tput sgr0)"
echo -e "$(tput setaf 1)You need to edit your config file to your liking in the following location:${PWD}/frameworkconsole/config\n"; echo "$(tput sgr0)"

echo -e "$(tput setaf 1)Once config is setup you can either run ./framework.py in the frameworkconsole directory,\n"; echo "$(tput sgr0)"
echo -e "$(tput setaf 1)This concludes the install.. enjoy!"; echo "$(tput sgr0)"


